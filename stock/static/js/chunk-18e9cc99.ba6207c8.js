(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18e9cc99"],{"1e8b":function(e,t,a){},3277:function(e,t,a){"use strict";var r=a("1e8b"),n=a.n(r);n.a},"49fe":function(e,t,a){},"4b94":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail-page"},[a("back"),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v(" "+e._s(e.basicInfo.address)+" 户 "+e._s(e.basicInfo.familyNo)+" ("+e._s(e.basicInfo.name)+") "),a("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.addMember}},[e._v("新增家庭成员")])],1),a("div",{staticStyle:{padding:"10px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":"table-header-color",data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"memberName",label:"成员"}}),a("el-table-column",{attrs:{prop:"relationship",label:"与户主关系"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.relationshipList.length?a("p",[e._v(e._s(e.relationshipList.filter((function(e){return e.relationshipId==t.row.relationship}))[0].relationshipName))]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"sex",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.sex?a("p",[e._v("保密")]):1==t.row.sex?a("p",[e._v("男")]):2==t.row.sex?a("p",[e._v("女")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"idCard",label:"身份证号",width:"230"}}),a("el-table-column",{attrs:{prop:"birthDate",label:"出生日期"}}),a("el-table-column",{attrs:{prop:"currentAddress",label:"现居住地"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-s-tools",type:"success"},on:{click:function(a){return e.handleEdit("editMember",t.row.memberId)}}},[e._v("变更")]),a("el-button",{attrs:{icon:"el-icon-warning",type:"warning"},on:{click:function(a){return e.handleEdit("detail",t.row.memberId)}}},[e._v("详情")]),a("el-button",{attrs:{icon:"el-icon-delete-solid",type:"danger"},on:{click:function(a){return e.deleteMember(t.row)}}},[e._v("注销")])]}}])})],1)],1)]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v(" "+e._s(e.basicInfo.address)+" 户 "+e._s(e.basicInfo.familyNo)+" ("+e._s(e.basicInfo.name)+") "),a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("变更记录")])],1),a("div",{staticStyle:{padding:"10px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":"table-header-color",data:e.memberUpdateHistoryInfos,border:""}},[a("el-table-column",{attrs:{prop:"updateTime",label:"变更时间"}}),a("el-table-column",{attrs:{prop:"memberName",label:"成员名"}}),a("el-table-column",{attrs:{prop:"updateDetail",label:"变更详情"}})],1)],1)]),a("el-dialog",{attrs:{title:"关系变更",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{"label-width":"80px"}},e._l(e.tableData.filter((function(e){return 1!==e.relationship})),(function(t){return a("el-form-item",{key:t.memberId,attrs:{label:t.memberName}},[a("el-select",{attrs:{filterable:"",placeholder:"更新关系"},model:{value:e.form[t.memberId],callback:function(a){e.$set(e.form,t.memberId,a)},expression:"form[item.memberId]"}},e._l(e.relationshipList,(function(e){return a("el-option",{key:e.relationshipId,attrs:{label:e.relationshipName,value:e.relationshipId}})})),1)],1)})),1),a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.changeRelationship(e.currentId)}}},[e._v("确 定")])],1)],1)},n=[],i=(a("99af"),a("4de4"),a("d81d"),a("b0c0"),a("b64b"),a("d130")),o=a("66b7"),l=a("8194"),s={name:"OrganizationDetail",components:{FormItemLayout:i["a"],Back:o["a"]},data:function(){return{memberUpdateHistoryInfos:[],tableData:[],basicInfo:{},form:{},dialogVisible:!1,relationshipList:[],currentId:""}},created:function(){var e=this;this.basicInfo={address:this.$route.query.village,name:this.$route.query.name,familyNo:this.$route.query.familyNo},this.getFamilyMember(),this.getRelationList();var t=new FormData;t.append("familyId",this.$route.query.id),Object(l["g"])(t).then((function(t){e.memberUpdateHistoryInfos=t.data.memberUpdateHistoryInfos}))},methods:{handleEdit:function(e,t){if("detail"==e)this.$router.push("/member/edit?isEdit=".concat(e,"&memberId=").concat(t,"&familyCount=").concat(this.basicInfo.familyNo));else{var a=this.$route.query.id;this.$router.push("/member/edit?isEdit=".concat(e,"&id=").concat(a,"&memberId=").concat(t,"&familyCount=").concat(this.basicInfo.familyNo))}},addMember:function(){var e=this.$route.query.id;this.$router.push("/member/edit?isEdit=addMember&id=".concat(e,"&familyCount=").concat(this.basicInfo.familyNo))},goDetail:function(){this.$router.push("/member/detail")},deleteMember:function(e){var t=this;this.$confirm("确认注销？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=e.memberId;1===e.relationship&&t.tableData.length>1?(t.dialogVisible=!0,t.currentId=a):t.cancleMember(a)}))},cancleMember:function(e,t){var a=this,r={memberId:e};if(t){var n=t.filter((function(e){return 1===e.relationship}));if(!n.length)return void this.$message.error("必须有一成员为户主");r.memberRelationships=t,r.memberId=this.currentId}Object(l["b"])(r).then((function(e){a.$message({type:"success",message:"操作成功！"}),a.dialogVisible=!1,a.getFamilyMember()}))},makeSureCancle:function(e){var t=this;console.log(this.form);var a=Object.keys(this.form),r=[];a.map((function(e){r.push({memberId:e,relationship:t.form[e]})})),this.cancleMember(e,r)},getFamilyMember:function(){var e=this,t=this.$route.query.id;Object(l["e"])({familyId:t}).then((function(t){e.tableData=t.data.memberInfos}))},getRelationList:function(e){var t=this;Object(l["j"])({villageId:e}).then((function(e){t.relationshipList=e.data.relationshipInfos||[]}))},changeRelationship:function(e){this.makeSureCancle(e)}}},c=s,u=(a("c680"),a("6c6f"),a("2877")),d=Object(u["a"])(c,r,n,!1,null,"794e46cb",null);t["default"]=d.exports},"6c6f":function(e,t,a){"use strict";var r=a("9352"),n=a.n(r);n.a},8194:function(e,t,a){"use strict";a.d(t,"k",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"h",(function(){return s})),a.d(t,"j",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"f",(function(){return f})),a.d(t,"l",(function(){return b})),a.d(t,"i",(function(){return h})),a.d(t,"g",(function(){return p}));var r=a("b775");function n(e){return Object(r["a"])({url:"/v1/family/search",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/v1/family/save",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/v1/member/detail",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/v1/family/members",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/v1/member/detail",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/v1/relationship/query",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/v1/member/update",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/v1/member/cancel",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/v1/member/save",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/v1/birthDate/query",method:"post",data:e})}function b(e){return Object(r["a"])({url:"/v1/members/search",method:"post",data:e})}function h(e){return Object(r["a"])({url:"/v1/member/download",method:"get",params:e,responseType:"blob"})}function p(e){return Object(r["a"])({url:"/v1/updateHistory/query",method:"post",data:e})}},9352:function(e,t,a){},a9e3:function(e,t,a){"use strict";var r=a("83ab"),n=a("da84"),i=a("94ca"),o=a("6eeb"),l=a("5135"),s=a("c6b6"),c=a("7156"),u=a("c04e"),d=a("d039"),m=a("7c73"),f=a("241c").f,b=a("06cf").f,h=a("9bf2").f,p=a("58a8").trim,v="Number",y=n[v],I=y.prototype,g=s(m(I))==v,_=function(e){var t,a,r,n,i,o,l,s,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=p(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+c}for(i=c.slice(2),o=i.length,l=0;l<o;l++)if(s=i.charCodeAt(l),s<48||s>n)return NaN;return parseInt(i,r)}return+c};if(i(v,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var N,w=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof w&&(g?d((function(){I.valueOf.call(a)})):s(a)!=v)?c(new y(_(t)),a,w):_(t)},k=r?f(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),O=0;k.length>O;O++)l(y,N=k[O])&&!l(w,N)&&h(w,N,b(y,N));w.prototype=I,I.constructor=w,o(n,v,w)}},c680:function(e,t,a){"use strict";var r=a("49fe"),n=a.n(r);n.a},d130:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-item-box"},[a("span",{style:{display:"inline-block",width:e.labelWidth+"px"}},[e.required?a("span",{staticStyle:{color:"#f56c6c"}},[e._v("*")]):e._e(),e._v(" "+e._s(e.label)+" ")]),e._t("default")],2)},n=[],i=(a("a9e3"),a("2f62"),{name:"Dashboard",props:{label:String,labelWidth:{type:Number,default:100},required:Boolean}}),o=i,l=(a("3277"),a("2877")),s=Object(l["a"])(o,r,n,!1,null,"0679a4c4",null);t["a"]=s.exports}}]);