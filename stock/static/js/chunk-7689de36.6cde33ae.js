(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7689de36","chunk-193941d2"],{2934:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return l}));var a=r("b775");function o(){return Object(a["a"])({url:"/v1/village/list",method:"post"})}function n(){return Object(a["a"])({url:"/v1/position/query",method:"post"})}function l(e){return Object(a["a"])({url:"/v1/villageGroup/list",method:"post",data:e})}},3742:function(e,t,r){"use strict";var a=r("cf3e"),o=r.n(a);o.a},"462d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page-container"},[r("el-card",{staticClass:"box-card"},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("变更账户")]),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitForm("ruleForm","authForm")}}},[e._v("保存")])],1),r("div",{staticClass:"addAccount-main"},[r("el-card",{staticClass:"box-card-addAccount"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("基本信息")])]),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"账号",prop:"accountNo"}},[r("el-input",{attrs:{placeholder:"请输入账号",disabled:""},model:{value:e.ruleForm.accountNo,callback:function(t){e.$set(e.ruleForm,"accountNo",t)},expression:"ruleForm.accountNo"}})],1),r("el-form-item",{attrs:{label:"姓名",prop:"accountName"}},[r("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.ruleForm.accountName,callback:function(t){e.$set(e.ruleForm,"accountName",t)},expression:"ruleForm.accountName"}})],1),r("el-form-item",{attrs:{label:"电话",prop:"phone"}},[r("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),r("el-form-item",{attrs:{label:"职务",prop:"rule"}},[r("el-input",{attrs:{placeholder:"请输入职务"},model:{value:e.ruleForm.rule,callback:function(t){e.$set(e.ruleForm,"rule",t)},expression:"ruleForm.rule"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"description"}},[r("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1)],1)],1),r("el-card",{staticClass:"box-card-addAccount"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("权限设置")])]),r("div",{staticClass:"radio_check"},[r("el-form",{ref:"authForm",attrs:{model:e.authForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"所辖乡镇",prop:"manageVillages"}},[r("el-checkbox-group",{on:{change:e.changeTown},model:{value:e.authForm.manageVillages,callback:function(t){e.$set(e.authForm,"manageVillages",t)},expression:"authForm.manageVillages"}},e._l(e.townLists,(function(t,a){return r("el-checkbox",{key:"town"+a,attrs:{label:t.townshipId,name:"type"}},[e._v(e._s(t.townshipName))])})),1)],1),r("el-form-item",{attrs:{label:"所辖村庄"}},[r("p",{staticStyle:{margin:"0"}},[e._v("目前共计选中"+e._s(e.villageModel.length)+"个村庄！"),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.showDrawer=!e.showDrawer,e.viewVillage()}}},[e._v("查看详情")])],1)]),r("el-form-item",{attrs:{label:"组归属",prop:"accountGroupId"}},[r("el-checkbox-group",{model:{value:e.authForm.accountGroupId,callback:function(t){e.$set(e.authForm,"accountGroupId",t)},expression:"authForm.accountGroupId"}},e._l(e.group,(function(t,a){return r("el-checkbox",{key:a,attrs:{label:t.accountGroupId,name:"type"}},[e._v(e._s(t.accountGroupName))])})),1)],1)],1)],1)])],1)]),r("el-drawer",{attrs:{direction:"ltr",visible:e.showDrawer},on:{"update:visible":function(t){e.showDrawer=t}}},[r("p",{attrs:{slot:"title"},slot:"title"},[e._v("所辖村庄")]),r("el-checkbox-group",{staticClass:"custom-check",model:{value:e.villageModel,callback:function(t){e.villageModel=t},expression:"villageModel"}},e._l(e.villageList,(function(t,a){return r("el-checkbox",{key:"town"+a,attrs:{label:t.villageId,name:"type"}},[e._v(e._s(t.villageName))])})),1)],1)],1)},o=[];r("99af"),r("d81d"),r("d3b7"),r("3ca3"),r("ddb0");function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function l(e){if(Array.isArray(e))return n(e)}r("a4d3"),r("e01a"),r("d28b"),r("a630");function i(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}r("fb6a"),r("b0c0"),r("25f0");function s(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return l(e)||i(e)||s(e)||u()}function d(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return l=e.done,e},e:function(e){i=!0,n=e},f:function(){try{l||null==r["return"]||r["return"]()}finally{if(i)throw n}}}}var m=r("5530"),f=r("5723"),p=r("2934"),h=(r("5f87"),{name:"AccountAdminEdit",props:{isModule:{type:Boolean,default:!1}},data:function(){return{tableData:[],townLists:[],villageList:[],group:[],ruleForm:{},authForm:{manageVillages:[],accountGroupId:[]},villageModel:[],rules:{accountNo:[{required:!0,message:"账户名不能为空",trigger:"blur"}],accountName:[{required:!0,message:"姓名不能为空",trigger:"blur"}],phone:[{required:!0,message:"电话不能为空",trigger:"blur"}],manageVillages:[{type:"array",required:!0,message:"请至少选择一个所辖村庄",trigger:"change"}],accountGroupId:[{type:"array",required:!0,message:"请至少选择一个组归属",trigger:"change"}]},isEdit:!1,showDrawer:!1}},created:function(){console.log(this.$store.state),this.getGroupList(),this.getVillageList(),this.isEdit=!!this.isModule||this.$route.query.isEdit;var e=this.isModule?this.$store.state.user.accountId||localStorage.getItem("ai"):this.$route.query.accountid;this.isEdit&&e&&this.getAccountInfo(e)},methods:{submitForm:function(e,t){var r=this,a=new Promise((function(t,a){r.$refs[e].validate((function(e){e&&t()}))})),o=new Promise((function(e,a){r.$refs[t].validate((function(t){t&&e()}))}));Promise.all([a,o]).then((function(){var e=Object(m["a"])(Object(m["a"])(Object(m["a"])({},r.ruleForm),r.authForm),{},{manageVillages:r.villageModel}),t=null;t=r.isEdit?Object(f["f"])(e):Object(f["e"])(e),t.then((function(e){r.isModule?r.$message({message:"操作成功",type:"success"}):history.back()}))}))},addAccountBtn:function(){this.showPage=!1,this.addAccount=!0},getVillageList:function(){var e=this;Object(p["a"])().then((function(t){e.townLists=t.data.townshipInfos||[]}))},viewVillage:function(){var e=this,t=[];this.villageModel=[],console.log(e.authForm.manageVillages),console.log(e.townLists);for(var r=0;r<e.authForm.manageVillages.length;r++)for(var a=0;a<e.townLists.length;a++)e.townLists[a].townshipId==e.authForm.manageVillages[r]&&(t=t.concat(e.townLists[a].villageInfos));this.villageList=t;for(r=0;r<e.villageList.length;r++)e.villageModel.push(e.villageList[r].villageId)},changeTown:function(e){var t=[];this.villageModel=[];var r,a=d(e);try{for(a.s();!(r=a.n()).done;){var o,n=r.value,l=d(this.townLists);try{for(l.s();!(o=l.n()).done;){var i=o.value;if(i.townshipId===n){var s;t.push.apply(t,c(i.villageInfos||[]));var u=(i.villageInfos||[]).map((function(e){return e.villageId}));(s=this.villageModel).push.apply(s,c(u));break}}}catch(m){l.e(m)}finally{l.f()}}}catch(m){a.e(m)}finally{a.f()}this.villageList=t},getGroupList:function(){var e=this;Object(f["a"])().then((function(t){e.group=t.data.accountGroupInfos}))},getAccountInfo:function(e){var t=this;Object(f["c"])(e).then((function(e){var r=e.data;r.phone=r.phoneNum,t.ruleForm=r,t.$set(t.authForm,"accountGroupId",r.accountGroupIds),t.$set(t.authForm,"manageVillages",r.manageTownships),t.villageModel=r.manageVillages}))}}}),g=h,v=(r("e75c"),r("3742"),r("2877")),b=Object(v["a"])(g,a,o,!1,null,"2c7b6097",null);t["default"]=b.exports},cf3e:function(e,t,r){},d831:function(e,t,r){},e382:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("edit-account",{attrs:{"is-module":""}})},o=[],n=r("462d"),l={components:{editAccount:n["default"]}},i=l,s=r("2877"),u=Object(s["a"])(i,a,o,!1,null,null,null);t["default"]=u.exports},e75c:function(e,t,r){"use strict";var a=r("d831"),o=r.n(a);o.a}}]);