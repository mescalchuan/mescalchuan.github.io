(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a7b6af3c"],{2934:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return s}));var r=a("b775");function o(){return Object(r["a"])({url:"/v1/village/list",method:"post"})}function l(){return Object(r["a"])({url:"/v1/village/loadAll",method:"post"})}function n(){return Object(r["a"])({url:"/v1/position/query",method:"post"})}function s(e){return Object(r["a"])({url:"/v1/villageGroup/list",method:"post",data:e})}},"4ad1":function(e,t,a){},"4c2d":function(e,t,a){},"66b7":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"back-container"},[a("span",{staticClass:"custom-back",on:{click:e.goBack}},[a("i",{staticClass:"el-icon-back ",on:{click:e.goBack}}),e._v("返回 ")])])},o=[],l=(a("2f62"),{name:"Back",methods:{goBack:function(){history.back()}}}),n=l,s=(a("8ccd"),a("2877")),i=Object(s["a"])(n,r,o,!1,null,"1a422e96",null);t["a"]=i.exports},6966:function(e,t,a){"use strict";var r=a("4c2d"),o=a.n(r);o.a},"7b9a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("back"),a("el-card",{staticClass:"box-card"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("新建账户")])]),a("div",{staticClass:"addAccount-main"},[a("el-card",{staticClass:"box-card-addAccount",staticStyle:{"margin-right":"1%"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("基本信息")])]),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账号",prop:"accountNo"}},[a("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.ruleForm.accountNo,callback:function(t){e.$set(e.ruleForm,"accountNo",t)},expression:"ruleForm.accountNo"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),a("el-form-item",{attrs:{label:"姓名",prop:"accountName"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.ruleForm.accountName,callback:function(t){e.$set(e.ruleForm,"accountName",t)},expression:"ruleForm.accountName"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),a("el-form-item",{attrs:{label:"职务",prop:"rule"}},[a("el-input",{attrs:{placeholder:"请输入职务"},model:{value:e.ruleForm.rule,callback:function(t){e.$set(e.ruleForm,"rule",t)},expression:"ruleForm.rule"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm","authForm")}}},[e._v("保存")])],1)],1)],1),a("el-card",{staticClass:"box-card-addAccount"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("权限设置")])]),a("div",{staticClass:"radio_check"},[a("el-form",{ref:"authForm",attrs:{model:e.authForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"所辖乡镇",prop:"manageVillages"}},[a("el-checkbox-group",{on:{change:e.handleVillagesChange},model:{value:e.authForm.manageVillages,callback:function(t){e.$set(e.authForm,"manageVillages",t)},expression:"authForm.manageVillages"}},e._l(e.townLists,(function(t,r){return a("el-checkbox",{key:"town"+r,attrs:{label:t.townshipId,name:"type"}},[e._v(e._s(t.townshipName))])})),1)],1),a("el-form-item",{attrs:{label:"所辖村庄"}},[a("p",{staticStyle:{margin:"0"}},[e._v(" 目前共计选中"+e._s(e.villageModel.length)+"个村庄！ "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.showDrawer=!e.showDrawer,e.viewVillage()}}},[e._v("查看详情")])],1)]),a("el-form-item",{attrs:{label:"组归属",prop:"accountGroupId"}},[a("el-checkbox-group",{model:{value:e.authForm.accountGroupId,callback:function(t){e.$set(e.authForm,"accountGroupId",t)},expression:"authForm.accountGroupId"}},e._l(e.group,(function(t,r){return a("el-checkbox",{key:t.accountGroupId,attrs:{label:t.accountGroupId,value:t.accountGroupId,name:"type"}},[e._v(e._s(t.accountGroupName))])})),1)],1)],1)],1)]),a("el-drawer",{attrs:{direction:"ltr",visible:e.showDrawer},on:{"update:visible":function(t){e.showDrawer=t}}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("所辖村庄")]),a("el-checkbox-group",{staticClass:"custom-check",model:{value:e.villageModel,callback:function(t){e.villageModel=t},expression:"villageModel"}},e._l(e.villageList,(function(t,r){return a("el-checkbox",{key:"town"+r,attrs:{label:t.villageId,name:"type"}},[e._v(e._s(t.villageName))])})),1)],1)],1)])],1)},o=[],l=(a("a4d3"),a("e01a"),a("99af"),a("d3b7"),a("3ca3"),a("ddb0"),a("bd11"),a("5723"),a("2934")),n=a("66b7"),s=a("5f87"),i={name:"AccountAdminAdd",components:{Back:n["a"]},data:function(){return{showDrawer:!1,group:[],ruleForm:{accountNo:"",accountName:"",phone:"",email:"",description:"",rule:""},authForm:{manageVillages:[],accountGroupId:[]},townLists:[],villageList:[],villageModel:[],rules:{accountNo:[{required:!0,message:"账户名不能为空",trigger:"blur"},{min:3,max:100,message:"长度在 3 到 5 个字符",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}],accountName:[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:3,max:100,message:"长度在 2 到 10 个字符",trigger:"blur"}],phone:[{required:!0,message:"电话不能为空",trigger:"blur"},{min:11,max:11,message:"号码长度要为11",trigger:"blur"}],manageVillages:[{type:"array",required:!0,message:"请至少选择一个所辖村庄",trigger:"change"}],accountGroupId:[{type:"array",required:!0,message:"请至少选择一个组归属",trigger:"change"}]}}},created:function(){this.getVillageList(),this.getAccountGroup()},methods:{handleVillagesChange:function(){var e=this,t=[];this.villageModel=[];for(var a=0;a<e.authForm.manageVillages.length;a++)for(var r=0;r<e.townLists.length;r++)e.townLists[r].townshipId==e.authForm.manageVillages[a]&&(t=t.concat(e.townLists[r].villageInfos));this.villageList=t;for(a=0;a<e.villageList.length;a++)e.villageModel.push(e.villageList[a].villageId)},viewVillage:function(){var e=this,t=[];this.villageModel=[];for(var a=0;a<e.authForm.manageVillages.length;a++)for(var r=0;r<e.townLists.length;r++)e.townLists[r].townshipId==e.authForm.manageVillages[a]&&(t=t.concat(e.townLists[r].villageInfos));this.villageList=t;for(a=0;a<e.villageList.length;a++)e.villageModel.push(e.villageList[a].villageId)},getVillageList:function(){var e=this;Object(l["a"])().then((function(t){e.townLists=t.data.townshipInfos||[]}))},getAccountGroup:function(){var e=this;this.$http({method:"post",url:"/v1/accountGroup/list",data:{},headers:{"Content-Type":"application/json;charset=UTF-8","login-token":Object(s["a"])()}}).then((function(t){"操作成功"==t.msg&&(e.group=t.data.accountGroupInfos)}))},submitForm:function(e,t){var a=this,r=this,o=new Promise((function(t,r){a.$refs[e].validate((function(e){e&&t()}))})),l=new Promise((function(e,r){a.$refs[t].validate((function(t){t&&e()}))}));Promise.all([o,l]).then((function(){a.$http({method:"post",url:"/v1/account/save",data:{accountGroupIds:r.authForm.accountGroupId,accountName:r.ruleForm.accountName,accountNo:r.ruleForm.accountNo,description:r.ruleForm.description,email:r.ruleForm.email,manageVillages:r.villageModel,phone:r.ruleForm.phone,rule:r.ruleForm.rule,password:r.ruleForm.password},headers:{"Content-Type":"application/json;charset=UTF-8","login-token":Object(s["a"])()}}).then((function(e){"操作成功"==e.msg&&(r.$message({type:"success",message:"操作成功!"}),r.$router.push("/account/index"))})).catch((function(e){}))}))}}},c=i,u=(a("6966"),a("2877")),m=Object(u["a"])(c,r,o,!1,null,"ce9b6022",null);t["default"]=m.exports},"8ccd":function(e,t,a){"use strict";var r=a("4ad1"),o=a.n(r);o.a}}]);