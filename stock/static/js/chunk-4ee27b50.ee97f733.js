(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ee27b50"],{2934:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return n}));var l=a("b775");function o(){return Object(l["a"])({url:"/v1/village/list",method:"post"})}function r(){return Object(l["a"])({url:"/v1/position/query",method:"post"})}function n(e){return Object(l["a"])({url:"/v1/villageGroup/list",method:"post",data:e})}},"7b9a":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"box-card"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("新建账户")])]),a("div",{staticClass:"addAccount-main"},[a("el-card",{staticClass:"box-card-addAccount",staticStyle:{"margin-right":"1%"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("基本信息")])]),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账号",prop:"accountNo"}},[a("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.ruleForm.accountNo,callback:function(t){e.$set(e.ruleForm,"accountNo",t)},expression:"ruleForm.accountNo"}})],1),a("el-form-item",{attrs:{label:"姓名",prop:"accountName"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.ruleForm.accountName,callback:function(t){e.$set(e.ruleForm,"accountName",t)},expression:"ruleForm.accountName"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),a("el-form-item",{attrs:{label:"职务",prop:"rule"}},[a("el-input",{attrs:{placeholder:"请输入职务"},model:{value:e.ruleForm.rule,callback:function(t){e.$set(e.ruleForm,"rule",t)},expression:"ruleForm.rule"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm","authForm")}}},[e._v("保存")])],1)],1)],1),a("el-card",{staticClass:"box-card-addAccount"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("权限设置")])]),a("div",{staticClass:"radio_check"},[a("el-form",{ref:"authForm",attrs:{model:e.authForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"所辖乡镇",prop:"manageVillages"}},[a("el-checkbox-group",{on:{change:e.handleVillagesChange},model:{value:e.authForm.manageVillages,callback:function(t){e.$set(e.authForm,"manageVillages",t)},expression:"authForm.manageVillages"}},e._l(e.townLists,(function(t,l){return a("el-checkbox",{key:"town"+l,attrs:{label:t.townshipId,name:"type"}},[e._v(e._s(t.townshipName))])})),1)],1),a("el-form-item",{attrs:{label:"所辖村庄"}},[a("p",{staticStyle:{margin:"0"}},[e._v(" 目前共计选中"+e._s(e.villageModel.length)+"个村庄！ "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.showDrawer=!e.showDrawer,e.viewVillage()}}},[e._v("查看详情")])],1)]),a("el-form-item",{attrs:{label:"组归属",prop:"accountGroupId"}},[a("el-checkbox-group",{model:{value:e.authForm.accountGroupId,callback:function(t){e.$set(e.authForm,"accountGroupId",t)},expression:"authForm.accountGroupId"}},e._l(e.group,(function(t,l){return a("el-checkbox",{key:t.accountGroupId,attrs:{label:t.accountGroupId,value:t.accountGroupId,name:"type"}},[e._v(e._s(t.accountGroupName))])})),1)],1)],1)],1)]),a("el-drawer",{attrs:{direction:"ltr",visible:e.showDrawer},on:{"update:visible":function(t){e.showDrawer=t}}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("所辖村庄")]),a("el-checkbox-group",{staticClass:"custom-check",model:{value:e.villageModel,callback:function(t){e.villageModel=t},expression:"villageModel"}},e._l(e.villageList,(function(t,l){return a("el-checkbox",{key:"town"+l,attrs:{label:t.villageId,name:"type"}},[e._v(e._s(t.villageName))])})),1)],1)],1)])},o=[],r=(a("a4d3"),a("e01a"),a("99af"),a("d3b7"),a("3ca3"),a("ddb0"),a("bd11"),a("5723"),a("2934")),n=a("5f87"),i={name:"AccountAdminAdd",data:function(){return{showDrawer:!1,group:[],ruleForm:{accountNo:"",accountName:"",phone:"",email:"",description:"",rule:""},authForm:{manageVillages:[],accountGroupId:[]},townLists:[],villageList:[],villageModel:[],rules:{accountNo:[{required:!0,message:"账户名不能为空",trigger:"blur"},{min:3,max:100,message:"长度在 3 到 5 个字符",trigger:"blur"}],accountName:[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:3,max:100,message:"长度在 2 到 10 个字符",trigger:"blur"}],phone:[{required:!0,message:"电话不能为空",trigger:"blur"},{min:11,max:11,message:"号码长度要为11",trigger:"blur"}],manageVillages:[{type:"array",required:!0,message:"请至少选择一个所辖村庄",trigger:"change"}],accountGroupId:[{type:"array",required:!0,message:"请至少选择一个组归属",trigger:"change"}]}}},created:function(){this.getVillageList(),this.getAccountGroup()},methods:{handleVillagesChange:function(){var e=this,t=[];this.villageModel=[];for(var a=0;a<e.authForm.manageVillages.length;a++)for(var l=0;l<e.townLists.length;l++)e.townLists[l].townshipId==e.authForm.manageVillages[a]&&(t=t.concat(e.townLists[l].villageInfos));this.villageList=t;for(a=0;a<e.villageList.length;a++)e.villageModel.push(e.villageList[a].villageId)},viewVillage:function(){var e=this,t=[];this.villageModel=[];for(var a=0;a<e.authForm.manageVillages.length;a++)for(var l=0;l<e.townLists.length;l++)e.townLists[l].townshipId==e.authForm.manageVillages[a]&&(t=t.concat(e.townLists[l].villageInfos));this.villageList=t;for(a=0;a<e.villageList.length;a++)e.villageModel.push(e.villageList[a].villageId)},getVillageList:function(){var e=this;Object(r["a"])().then((function(t){e.townLists=t.data.townshipInfos||[]}))},getAccountGroup:function(){var e=this;this.$http({method:"post",url:"/v1/accountGroup/list",data:{},headers:{"Content-Type":"application/json;charset=UTF-8","login-token":Object(n["a"])()}}).then((function(t){"操作成功"==t.msg&&(e.group=t.data.accountGroupInfos)}))},submitForm:function(e,t){var a=this,l=this,o=new Promise((function(t,l){a.$refs[e].validate((function(e){e&&t()}))})),r=new Promise((function(e,l){a.$refs[t].validate((function(t){t&&e()}))}));Promise.all([o,r]).then((function(){a.$http({method:"post",url:"/v1/account/save",data:{accountGroupIds:l.authForm.accountGroupId,accountName:l.ruleForm.accountName,accountNo:l.ruleForm.accountNo,description:l.ruleForm.description,email:l.ruleForm.email,manageVillages:l.villageModel,phone:l.ruleForm.phone,rule:l.ruleForm.rule},headers:{"Content-Type":"application/json;charset=UTF-8","login-token":Object(n["a"])()}}).then((function(e){"操作成功"==e.msg&&(l.$message({type:"success",message:"操作成功!"}),l.$router.push("/account/index"))})).catch((function(e){}))}))}}},s=i,c=(a("ab87"),a("2877")),u=Object(c["a"])(s,l,o,!1,null,"11fe3902",null);t["default"]=u.exports},"873e":function(e,t,a){},ab87:function(e,t,a){"use strict";var l=a("873e"),o=a.n(l);o.a}}]);